<!DOCTYPE html>
<html lang="en">
<head>
    <title>Animation</title>
    <link rel="stylesheet" href="styles.css">
    <script src="drawings.js"></script>
</head>
<body>
    <canvas id="asteroids"></canvas>
    <script>
        let context = document.getElementById("asteroids").getContext("2d");
        context.canvas.width = window.innerWidth;
        context.canvas.height= window.innerHeight;

        function Asteroid(segments, radius, noise) {
            this.x = context.canvas.width * Math.random();
            this.y = context.canvas.height * Math.random();
            this.angle = 0;
            this.x_speed = context.canvas.width * (Math.random() - 0.5);
            this.y_speed = context.canvas.height * (Math.random() - 0.5);
            this.rotation_speed = 2 * Math.PI * (Math.random() - 0.5);
            this.radius = radius;
            this.noise = noise;
            this.shape = [];
            for (let i = 0; i < segments; i++) {
                this.shape.push(Math.random() - 0.5);
            }
        };
        Asteroid.prototype.update = function(elapsed) {
            if(this.x - this.radius + elapsed * this.x_speed > context.canvas.width) {
                this.x = -this.radius;
            }
            if(this.x + this.radius + elapsed * this.x_speed < 0) {
                this.x = context.canvas.width + this.radius;
            }
            if(this.y - this.radius + elapsed * this.y_speed > context.canvas.height) {
                this.y = -this.radius;
            }
            if(this.y + this.radius + elapsed * this.y_speed < 0) {
                this.y = context.canvas.height + this.radius;
            }
            this.x += elapsed * this.x_speed;
            this.y += elapsed * this.y_speed;
            this.angle = (this.angle + elapsed * this.rotation_speed) % (2 * Math.PI);
        }
        Asteroid.prototype.draw = function draw(context, guide) {
            context.save();
            context.translate(this.x, this.y);
            context.rotate(this.angle);
            draw_asteroid(
                context, 
                this.radius, 
                this.shape, 
                {
                    noise: this.noise, 
                    guide: guide
                }
            );
            context.restore();
        }

        var asteroids = [
            new Asteroid(24, 50, 0.2),
            new Asteroid(24, 50, 0.5),
        ];
        for (let i = 24; i < 30; i++) {
            asteroids.push(new Asteroid(i, 50 + (Math.random() * 10), 0.2))
        }
 
        function draw(context, guide) {
            if (guide) {
                draw_grid(context);
            }
            asteroids.forEach(function (asteroid) {
                asteroid.draw(context, guide);
            });
        }
        function update(elapsed) {
            asteroids.forEach(function (asteroid) {
                asteroid.update(elapsed);
            });
        }
        var previous, elapsed;
        function frame(timestamp) {
            context.clearRect(0, 0, context.canvas.width, context.canvas.height);
            if (!previous) {
                previous = timestamp;
            }
            elapsed = timestamp - previous;
            update(elapsed / 1000);
            draw(context, true);
            previous = timestamp;
            window.requestAnimationFrame(frame);
        }
        window.requestAnimationFrame(frame);
    </script>
</body>
</html>